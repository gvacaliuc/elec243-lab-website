<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Signal Processing in Matlab - ELEC 243 Labs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Signal Processing in Matlab";
    var mkdocs_page_input_path = "lab7/experiment_7-3.md";
    var mkdocs_page_url = "/lab7/experiment_7-3/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ELEC 243 Labs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab Home</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../..">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab-home/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab-home/lab-station-handbook/">Lab Station Handbook</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab-home/tools-and-resources/">Tools and Resources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab-home/virtualbench/">VirtualBench</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">References</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../references/patch-cords-and-cables/">Patch Cords and Cables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/breadboard/">The Breadboard</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/interface/">The Interface Modules</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/wiring/">Wiring</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/color_code/">Resistor Color Codes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/lab-report/">Lab Report</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/manuals-and-data-sheets/">Instruction Manuals and Data Sheets</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 1</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab1/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/safety/">Safety</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/background/">Background</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/experiment_1-1/">DC Measurements: the DMM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/plotting-help/">Plotting Data in Matlab</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/interlude/">Grounds and Grounding</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/experiment_1-2/">The Oscilloscope and Function Generator</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab1/postlude/">Cleaning Up</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 2</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab2/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab2/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab2/before-lab/">Before Lab</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab2/experiment_2-1/">Measuring Heat and Light</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab2/breadboard/">The Breadboard</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab2/experiment_2-2/">Electroacoustic Transducers II</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab2/experiment_2-3/">Optoelectronic Signal Sources and Sinks</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 3</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab3/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab3/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab3/background/">Background</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab3/experiment_3-1/">Voltage and Waveform Measurements</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab3/experiment_3-2/">Writing a Labview Program</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 4</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab4/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab4/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab4/experiment_4-1/">Labview as a Source of Signals</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab4/experiment_4-2/">Improved Resistance Measurement</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 5</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab5/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab5/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab5/experiment_5-1/">The 741 Op-Amp</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab5/experiment_5-2/">Voltage Amplifiers</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 6</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab6/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab6/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab6/experiment_6-1/">Transducer Amplifiers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab6/experiment_6-2/">Frequency Response</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 7</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../experiment_7-1/">Sampling and Quantization</a>
                </li>
                <li class="">
                    
    <a class="" href="../experiment_7-2/">Recording a Reference Signal</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Signal Processing in Matlab</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#experiment-73">Experiment 7.3</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#signal-processing-in-matlab">Signal Processing in Matlab</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Lab 8</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lab8/">Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab8/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lab8/experiment_8-1/">Digital Logic</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../finallab/">Final Lab</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Miscellanous Images</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../misc_images/">Home</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ELEC 243 Labs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Lab 7 &raquo;</li>
        
      
    
    <li>Signal Processing in Matlab</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="experiment-73">Experiment 7.3</h1>
<h2 id="signal-processing-in-matlab">Signal Processing in Matlab</h2>
<h3 id="equipment">Equipment</h3>
<ul>
<li>Lab PC with Matlab</li>
</ul>
<h3 id="part-a-simple-signal-processing">Part A: Simple Signal Processing</h3>
<p>One of the simplest things we can do to a signal is to <em>scale</em> it (i.e.
multiply it by a constant). Try: </p>
<pre><code class="matlab">out1 = .25 * sig1;
sound(out1, Fs) 
</code></pre>

<p>Or if you're lazy: </p>
<pre><code class="matlab">sound(.25 * sig1) 
</code></pre>

<p>We can also make the signal bigger: </p>
<pre><code class="matlab">sound(4 * sig1) 
</code></pre>

<p>About the simplest thing we can do to <em>two</em> signals is to add them together: </p>
<pre><code class="matlab">out2 = sig1 + sig2; 
</code></pre>

<p>Listen to <code>out2</code> and look at its spectrogram. <strong>Can you identify the two
different signals in both the audible and visual domains?</strong> </p>
<p>Both the A/D converter which digitized the input signal and the D/A converter
which converts the processed samples back to an analog signal have limited
range of values that they can represent. By keeping our input signal below <span>\(5V\)</span>
we keep it within the range of the A/D converter and avoid "clipping" the
signal. However, when we add two signals together or send then through systems
having a gain greater than one, we may create an output signal with values too
large for the D/A converter to convert. If this happens you will hear
distortion in the output signal.  To avoid this, you can use the <code>soundsc()</code>
command instead of <code>sound()</code>. This command automatically scales the signal
value so that it fits within the range of the D/A converter.  </p>
<p>Another interesting thing we can do is <em>multiply</em> the two signals together.
Digitally, this is just as easy to do as adding them, but this is very
difficult to do in an analog circuit. </p>
<pre><code class="matlab">out3 = sig1 .* sig2;
</code></pre>

<p>Note the special MATLAB construct <code>.*</code> denoting point by point multiplication,
as opposed to matrix multiplication. Listen to <code>out3</code> and look at its
spectrogram. Can you identify either of the two signals in either the aural or
visual domains? </p>
<h3 id="part-b-simple-filtering">Part B: Simple Filtering</h3>
<p>As you saw in ELEC241, filtering a digital signal involves forming a weighted sum
of the past input and output samples:</p>
<span>\[
a_0y(n) = \sum_{k=1}^{M} a_ky(n-k) + \sum_{k=1}^{N} b_kx(n-k)
\]</span><p>Matlab has a function for performing this operation: </p>
<pre><code class="matlab">y = filter(b, a, x); 
</code></pre>

<p>Choosing the values of the <span>\(a_k\)</span>'s and <span>\(b_k\)</span>'s is the art of <em>filter design,</em>
which we'll look at in the next part. For now, we'll just try a few simple
values for <span>\(\vec{a}\)</span> and <span>\(\vec{b}\)</span>. As a tip, record the characteristics of
each filter we look at - you will be asked to summarize each type at the end of
experiment 9.4. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Record the characteristics of each filter as you look at them - <strong>you will
be asked to summarize each type at the end of the lab.</strong></p>
</div>
<p>A <em>finite impulse response</em> (FIR) or non-recursive filter has all the <span>\(a_k\)</span>
(except <span>\(a_0\)</span>) equal to zero, i.e. it is a weighted sum of input samples.  The
simplest FIR filter is the <em>boxcar</em> filter in which all the <span>\(b_k\)</span> are equal to 1.
Define a length 5 boxcar filter:</p>
<pre><code class="matlab">a=1; 
b=[1 1 1 1 1]; 
</code></pre>

<p>Matlab has a function to compute and display the frequency response of a
filter: </p>
<pre><code class="matlab">freqz(b, a) 
</code></pre>

<p><strong>Take a screenshot.</strong></p>
<p>Note that the frequency axis is labeled in terms of the Nyquist frequency,
which is half the sampling rate. So for our sampling rate, 1 corresponds to 5 kHz.
Although it is a little distorted because of the logarithmic scaling, this is a
close relative of our old friend <span>\(sin(x)/x\)</span>. Also note that the jumps in phase
are caused by a change in sign of the transfer function (the magnitude is
always positive).  Taking this into account, the phase is a <em>linear</em> function
of frequency.  </p>
<p>We can also look at the <em>unit-sample response</em> of the filter: </p>
<pre><code class="matlab">delta = \[1 zeros(1,100)\];
y = filter(b, a, delta); 
plot(y, '.') 
</code></pre>

<p>As you would expect, the unit-sample response is a rectangular pulse, which
supposedly looks like the side view of a boxcar. Now let's try applying this
filter to our signal:</p>
<pre><code class="matlab">out1 = filter(b, a, sig1); 
</code></pre>

<p>Listen to <code>out1</code> and look at its spectrogram. </p>
<pre><code class="matlab">sound(out1, Fs);
specgram(out1, 156, Fs) 
</code></pre>

<p>As you can tell from its frequency response plot, this is a "sort-of" lowpass
filter, though not a very good one. <strong>Can you tell this by comparing the sound
and spectrogram of the output with the input? What do the blue areas of the
spectrogram correspond to?</strong>  </p>
<p><strong>Repeat from the beginning of Part B using a length 10 boxcar filter.</strong>  </p>
<p><strong>What is the relation between the length of the filter and its frequency
response?</strong> An <em>infinite impulse response</em> (IIR) filter has an unit-sample
response that doesn't go to zero after a finite number of samples.  IIR filters
are usually implemented <em>recursively</em>, i.e. with non-zero <span>\(a\)</span> coefficients.
Define a first order recursive filter: </p>
<pre><code class="matlab">a=[1, -.9];
b=[1]; 
</code></pre>

<p>Using the same technique as above, look at its unit-sample and frequency
response. Note that this is also a lowpass filter, with a more conventional
frequency response than the boxcar filter. Apply this filter to the input
signal. Listen to the output and plot its spectrogram. <strong>Can you tell by
listening and looking that this is a lowpass filter?</strong> An interesting thing
happens if we change the sign of <span>\(a_1\)</span>: </p>
<pre><code class="matlab">a = [1 .9]; 
</code></pre>

<p>Look at the unit-sample and frequency response of this filter. Apply it to the
input signal, listen to the output, and plot its spectrogram. <strong>What kind of
filter is this?</strong> </p>
<h3 id="part-c-fancy-filtering">Part C: Fancy Filtering</h3>
<p>To get filters that are really effective (i.e. that pass the desired
frequencies with minimum distortion and reject undesired frequencies as
strongly as possible), we need to have a design procedure to find the optimum
set of coefficients for a given specification. If you take ELEC 431, you will
learn how to do this. In the meantime, we will utilize pre-constructed
algorithms.  The <em>Butterworth</em> filter is one of the classic filter designs. It
is characterized by having the "flattest" possible passband. Unfortunately, its
performance in the stop band is decidedly mediocre. Design a <span>\(5^{th}\)</span>-order
lowpass Butterworth filter having a cutoff frequency of 600 Hz with our 10 kHz
sampling frequency and print out their coefficients: </p>
<pre><code class="matlab">[b,a] = butter(5, 600/5000);
b
a 
</code></pre>

<p>Look at the unit-sample response and the frequency response. Notice how much
closer this is to an ideal low pass filter. Also notice the scale on the
y-axis. For a better comparison with previous plots, try changing this scale: </p>
<pre><code class="matlab">subplot(2,1,1)
axis([0 1 -60 0]) 
</code></pre>

<p>Also
note that the phase is not linear. Now apply the filter to our input
signal and listen to the output: </p>
<pre><code class="matlab">out=filter(b,a,sig1);
sound(out, Fs) 
</code></pre>

<p>We can also design FIR filters that are significantly better than our boxcar
filter: </p>
<pre><code class="matlab">a=1
b=fir1(5,600/5000); 
</code></pre>

<p>Examine the unit-sample and frequency response of this filter and apply it to
the reference signal. FIR filters really start to get interesting when we build
very long ones.  Try the same cutoff frequency with 50 coefficients: </p>
<pre><code class="matlab">b=fir1(50,600/5000); 
</code></pre>

<p>Note that we now have a filter of order 50.  How would you like to design and
build an analog (RLC) filter of this order?! <strong>Look at the unit-sample and
frequency response of this filter. What function does the unit-sample response
remind you of?</strong> Note that this filter has a much more ideal shape than any of
the others. </p>
<p>Finally apply this filter to the reference signal. <strong>Can you tell the
difference in the sound or the spectrogram between the effects of this filter
and the length 5 filter?</strong> </p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>You will need your signals <code>sig1</code> and <code>sig2</code> for the next lab so make sure
you save them!</p>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../lab8/" class="btn btn-neutral float-right" title="Home">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../experiment_7-2/" class="btn btn-neutral" title="Recording a Reference Signal"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../experiment_7-2/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../lab8/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>
      <script src="../../mathjax-config.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
